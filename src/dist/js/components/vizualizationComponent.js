import{renderChart}from"../dataVisualization/chartJS.js";import{renderD3}from"../dataVisualization/d3.js";import{renderInfogram}from"../dataVisualization/infogram.js";import{renderEasel}from"../dataVisualization/easel.js";import{getData}from"../utils/requestData.js";import{QUESTIONS}from"../dataVisualization/questionsBase.js";export default class VisualizationComponnet{constructor(){this.visualizations={chartJSbar:{selector:"chartJS-bar",title:"NMP",renderFunction:renderChart,type:"line",data:getData("NMP"),question:QUESTIONS.nmp[1],notVisible:!0},chartJSdoughnut:{selector:"chartJS--doughnut",title:"Izglītojamo skaits profesionālās izglītības programmās uz 01.01.2024",renderFunction:renderChart,type:"doughnut",data:getData("students"),question:QUESTIONS.students[2]},d3doughnut:{selector:"d3--doughnut",title:"Izglītojamo skaits uz 01.01.2024",renderFunction:renderD3,type:"doughnut",data:getData("students-d3"),question:QUESTIONS.students[1]},infogram:{selector:"inforgam",title:"Test",renderFunction:renderInfogram,type:"",data:getData("NMP"),question:QUESTIONS.nmp[1]},easel:{selector:"easel",title:"Test",renderFunction:renderEasel,type:"",data:getData("NMP"),question:QUESTIONS.nmp[1]}}}init(){this.createVisualizations(),this.renderBasicQuestions(),this.addInputListeners(),this.renderSendButton(!1)}addInputListeners(){let t=document.querySelectorAll("input"),a=()=>{var e=Array.from(t).every(e=>""!==e.value.trim());this.renderSendButton(e),console.log("Filled",e)};console.log("inputs",t),t.forEach(e=>{e.addEventListener("input",a)})}createVisualizations(){let a=document.getElementById("main");Object.values(this.visualizations).forEach(e=>{var t=this.createVisualizationSection(e);t&&(a.appendChild(t),"function"==typeof e.renderFunction)&&e.renderFunction("js-visualization-"+e.selector,e.type,e.data)})}createElement(e,t="",a=[],n=""){let i=document.createElement(e);return t&&(i.className=t),n&&(i.textContent=n),a.forEach(e=>i.appendChild(e)),i}createVisualizationSection(e){var t,a;return e.notVisible?null:((t=document.createElement("div")).className="main__section__wrapper navigation-section",t.id="section-"+e.selector,t.setAttribute("data-title",e.title),a=this.createElement("div","data-visualization__wrapper",[this.createElement("div","visualization-title",[],e.title),this.createElement("div","js-visualization-"+e.selector)]),e=this.createElement("div","form__wrapper",[this.createElement("label","",[],e.question),this.createElement("input","js-form-input-"+e.selector)]),t.appendChild(a),t.appendChild(e),t)}renderBasicQuestions(){let a=document.getElementById("main");var e=document.createElement("h2"),t=(e.classList.add("questions-title"),e.textContent="Atbildiet uz papildus jautājumiem:",document.createElement("hr")),t=(t.classList.add("questions-separator"),a.appendChild(t),a.appendChild(e),QUESTIONS.basic);Object.entries(t).forEach(([e,t])=>{e=this.renderBasicQuestion(e,t);a.appendChild(e)})}renderBasicQuestion(e,t){var a=document.createElement("div"),t=this.createElement("div","form__wrapper--tight",[this.createElement("label","",[],t),this.createElement("input","js-form-input-question-"+e)]);return a.append(t),a}renderSendButton(e){var t=document.getElementById("main");let a=t.querySelector(".submition-section");a||((a=document.createElement("div")).className="submition-section");var n=a.querySelector(".js-send-button"),i=a.querySelector(".js-warning-message, .js-thank-you-message");n&&n.remove(),i&&i.remove(),e?((n=document.createElement("button")).className="js-send-button button--regular",n.innerHTML='<i class="fa-regular fa-paper-plane"></i> Nosūtīt atbildes',n.addEventListener("click",function(){var e=a.querySelector(".js-send-button");e&&e.remove(),(e=document.createElement("div")).className="js-thank-you-message alert alert-success",e.innerHTML='<i class="fa-solid fa-fire"></i> Paldies par dalību! Forma nosūtīta :)',a.appendChild(e),document.querySelectorAll("input, textarea, select").forEach(e=>{e.disabled=!0})}),a.appendChild(n)):((i=document.createElement("div")).className="js-warning-message alert alert-warning",i.innerHTML='<i class="fa-solid fa-triangle-exclamation"></i> Lai nosūtītu formu, jāaizpilda visi lauki.',a.appendChild(i)),t.contains(a)||t.appendChild(a)}}