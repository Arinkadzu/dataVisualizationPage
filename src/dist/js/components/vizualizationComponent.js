import{renderChart}from"../dataVisualization/chartJS.js";import{renderD3}from"../dataVisualization/d3.js";import{renderInfogram}from"../dataVisualization/infogram.js";import{renderEasel}from"../dataVisualization/easel.js";import{getData}from"../utils/requestData.js";import{QUESTIONS}from"../dataVisualization/questionsBase.js";export default class VisualizationComponnet{constructor(){this.visualizations={chartJSdoughnut:{selector:"chartJS--doughnut",title:"Izglītojamo skaits profesionālās izglītības programmās uz 01.01.2024",renderFunction:renderChart,type:"doughnut",data:getData("students"),question:QUESTIONS.students[2]},d3doughnut:{selector:"d3--doughnut",title:"Medicīniskās palīdzības pieprasījumi pēc vecuma grupām",renderFunction:renderD3,type:"doughnut",data:getData("NMP"),question:QUESTIONS.nmp[1]},infogram:{selector:"inforgam",title:"Test",renderFunction:renderInfogram,type:"",data:getData("NMP"),question:QUESTIONS.nmp[1]},easel:{selector:"easel",title:"Test",renderFunction:renderEasel,type:"",data:getData("NMP"),question:QUESTIONS.nmp[1]}}}init(){this.createVisualizations(),this.renderBasicQuestions(),this.addInputListeners(),this.renderSendButton(!1)}addInputListeners(){let t=document.querySelectorAll("input"),a=()=>{var e=Array.from(t).every(e=>""!==e.value.trim());this.renderSendButton(e),console.log("Filled",e)};console.log("inputs",t),t.forEach(e=>{e.addEventListener("input",a)})}createVisualizations(){let a=document.getElementById("main");Object.values(this.visualizations).forEach((e,t)=>{t=this.createVisualizationSection(e,t);t&&(a.appendChild(t),"function"==typeof e.renderFunction)&&e.renderFunction("js-visualization-"+e.selector,e.type,e.data)})}createElement(e,t="",a=[],i=""){let n=document.createElement(e);return t&&(n.className=t),i&&(n.textContent=i),a.forEach(e=>n.appendChild(e)),n}generateTitle(e,t){var e=this.createElement("div","title-number",[],e+1+". diagramma:"),t=this.createElement("div","title-text",[],t),a=this.createElement("div","visualization-title",[]);return a.appendChild(e),a.appendChild(t),a}createVisualizationSection(e,t){var a;return e.notVisible?null:((a=document.createElement("div")).className="main__section__wrapper navigation-section",a.id="section-"+e.selector,a.setAttribute("data-title",e.title),t=this.generateTitle(t,e.title),t=this.createElement("div","data-visualization__wrapper",[t,this.createElement("div","js-visualization-"+e.selector)]),e=this.createElement("div","form__wrapper",[this.createElement("label","",[],e.question),this.createElement("input","js-form-input-"+e.selector)]),a.appendChild(t),a.appendChild(e),a)}renderBasicQuestions(){let a=document.getElementById("main");var e=document.createElement("h2"),t=(e.classList.add("questions-title"),e.textContent="Atbildiet uz papildus jautājumiem:",document.createElement("hr")),t=(t.classList.add("questions-separator"),a.appendChild(t),a.appendChild(e),QUESTIONS.basic);Object.entries(t).forEach(([e,t])=>{e=this.renderBasicQuestion(e,t);a.appendChild(e)})}renderBasicQuestion(e,t){var a=document.createElement("div"),t=this.createElement("div","form__wrapper--tight",[this.createElement("label","",[],t),this.createElement("input","js-form-input-question-"+e)]);return a.append(t),a}renderSendButton(e){var t=document.getElementById("main");let a=t.querySelector(".submition-section");a||((a=document.createElement("div")).className="submition-section");var i=a.querySelector(".js-send-button"),n=a.querySelector(".js-warning-message, .js-thank-you-message");i&&i.remove(),n&&n.remove(),e?((i=document.createElement("button")).className="js-send-button button--regular",i.innerHTML='<i class="fa-regular fa-paper-plane"></i> Nosūtīt atbildes',i.addEventListener("click",function(){var e=a.querySelector(".js-send-button");e&&e.remove(),(e=document.createElement("div")).className="js-thank-you-message alert alert-success",e.innerHTML='<i class="fa-solid fa-fire"></i> Paldies par dalību! Forma nosūtīta :)',a.appendChild(e),document.querySelectorAll("input, textarea, select").forEach(e=>{e.disabled=!0})}),a.appendChild(i)):((n=document.createElement("div")).className="js-warning-message alert alert-warning",n.innerHTML='<i class="fa-solid fa-triangle-exclamation"></i> Lai nosūtītu formu, jāaizpilda visi lauki.',a.appendChild(n)),t.contains(a)||t.appendChild(a)}}